<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<h:head>
    <title>Projects List Form</title>
</h:head>

<h:body>
    <h:form id="listForm">
		<p:dataTable style="margin-bottom:40px"
				var="project" widgetVar="projects" 
				value="#{projectsViewController.projects}" 
					filteredValue="#{projectsViewController.filteredProjects}"
					sortBy="#{project.projectNo}" >
	        
	        <f:facet name="header">
	            Project List Form with Filters::
	        </f:facet>
	        
			<p:column style="width:32px;text-align: center">
            		<p:commandButton icon="ui-icon-search" title="View" action="/forms/ProjectEditForm.xhtml">
                		<f:setPropertyActionListener value="#{project}" 
                			target="#{projectsViewController.selectedProject}" />
            		</p:commandButton>
        		</p:column>	        
	        <p:column headerText="Project#" sortBy="#{project.projectNo}"
	        		 filterBy="#{project.projectNo}" filterMatchMode="contains" footerText="contains">
	            <h:outputText value="#{project.projectNo}" />
	        </p:column>
	        
			<p:column headerText="Name" sortBy="#{project.name}"
					filterBy="#{project.name}" filterMatchMode="contains" footerText="contains">
	            <h:outputText value="#{project.name}" />
	        </p:column>	 
	        
	        <p:column headerText="StartDate" sortBy="#{project.startDate}"
	        		filterBy="#{project.startDate}" filterFunction="#{projectsViewController.filterByDate}" 
	        		footerText="equals truncate">
	        	<f:facet name="filter">
	        		<p:calendar pattern="dd/MM/yyyy">
	        			<p:ajax event="dateSelect"  oncomplete="PF('projects').filter()"/>
	        		</p:calendar>
	        	</f:facet>
	            <h:outputText value="#{project.startDate}">
	            	<f:convertDateTime pattern="dd/MM/yyyy" />
	            </h:outputText>
	        </p:column>        
	    </p:dataTable>      
    </h:form>
</h:body>
</html>